<!DOCTYPE html>
<html>
<head>
	<title>Number Plate Detection</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			background-color: #f4f4f4;
		}

		h1 {
			text-align: center;
			margin-top: 50px;
		}

		#video {
			display: block;
			margin: auto;
			margin-top: 30px;
			border: 5px solid #333;
		}

		#canvas {
			display: none;
		}
	</style>
</head>
<body>
	<h1>Number Plate Detection</h1>
	<video id="video" width="640" height="480"></video>
	<canvas id="canvas" width="640" height="480"></canvas>

	<!-- Load the required libraries -->
	<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-core"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-converter"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/face-landmarks-detection"></script>

	<script>
		const video = document.getElementById('video');
		const canvas = document.getElementById('canvas');
		const context = canvas.getContext('2d');

		// Replace with your Telegram bot token and chat ID
		const TELEGRAM_BOT_TOKEN = 'YOUR_TELEGRAM_BOT_TOKEN_HERE';
		const TELEGRAM_CHAT_ID = 'YOUR_TELEGRAM_CHAT_ID_HERE';

		// Load the number plate recognition model
		tf.loadGraphModel('numberplate_recognition_model/model.json').then(model => {
			// Start the video stream from the internal camera
			navigator.mediaDevices.getUserMedia({
				video: {
					facingMode: "user"
				}
			}).then(stream => {
				video.srcObject = stream;
				video.play();

				// Set up a timer to run the face detection and number plate recognition every second
				setInterval(() => {
					// Capture a frame from the video stream and display it on the canvas
					context.drawImage(video, 0, 0, canvas.width, canvas.height);

					// Convert the canvas image to a tensor and preprocess it
					const imageTensor = tf.browser.fromPixels(canvas).expandDims().toFloat().div(tf.scalar(255));
					const preprocessedTensor = tf.image.resizeBilinear(imageTensor, [224, 224]);

					// Get the predictions from the number plate recognition model
					const predictions = model.predict(preprocessedTensor);

					// Decode the predictions to get the number plate text
					const prediction = Array.from(predictions.dataSync()).map(x => String.fromCharCode(x)).join('');

					// Send the number plate text to the Telegram bot
					fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage?chat_id=${TELEGRAM_CHAT_ID}&text=${prediction}`);
				}, 1000);
			}).catch(error => {
				console.error(error);
				alert("Unable to access the camera.");
			});
		});
	</script>
</body>
</html>
